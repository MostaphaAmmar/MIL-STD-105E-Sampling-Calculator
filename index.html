<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MIL-STD-105E Sampling Calculator</title>

<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    select, input, button { margin-bottom: 15px; padding: 8px; width: 100%; }
    .result { margin-top: 20px; font-weight: bold; font-size: 18px; }
    .accepted { color: green; }
    .rejected { color: red; }
    .hidden { display: none; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .logo { max-height: 80px; }
</style>
</head>

<body>

<div class="header">
    <img src="Scitra logo.jpg" alt="Scitra Logo" class="logo">
    <div>
        <h2>QC Section</h2>
        <h3>Quality Department</h3>
    </div>
</div>

<h1>MIL-STD-105E / ISO 2859-1 Sampling Calculator</h1>

<label>Lot Size (Numeric Value):</label>
<input type="number" id="lotSize" min="300" placeholder="Enter total lot quantity">

<label>General Inspection Level:</label>
<select id="inspectionLevel">
    <option value="I">Level I</option>
    <option value="II" selected>Level II (Default)</option>
    <option value="III">Level III</option>
</select>

<label>Inspection Status (Switching Rule):</label>
<select id="inspectionStatus">
    <option value="normal">Normal</option>
    <option value="tightened">Tightened</option>
    <option value="reduced">Reduced</option>
</select>

<button onclick="calculateSampleSize()">Calculate Sample Size</button>

<div class="result" id="sampleSize"></div>

<div id="defectSection" class="hidden">

<label>Defect Category (AQL):</label>
<select id="defectType">
    <option value="critical">Critical (AQL 0.0)</option>
    <option value="major">Major (AQL 1.0)</option>
    <option value="minor">Minor (AQL 4.0)</option>
</select>

<label>Number of Defects Found:</label>
<input type="number" id="defectCount" min="0">

<button onclick="calculateAcceptance()">Calculate Acceptance Decision</button>

<div class="result" id="result"></div>

</div>

<script>

// Sample size matrix (Aâ€“H internally mapped to 0â€“7 index)
const sampleSizeMatrix = {
    I:   [32, 50, 80, 125, 200, 315, 500, 800],
    II:  [50, 80, 125, 200, 315, 500, 800, 1250],
    III: [80, 125, 200, 315, 500, 800, 1250, 1250]
};

let currentSampleSize = 0;

// ðŸ”¹ Automatic Lot Size Classification
function getPopulationIndex(lotSize) {
    if (lotSize >= 300 && lotSize <= 500) return 0;
    else if (lotSize <= 1200) return 1;
    else if (lotSize <= 3200) return 2;
    else if (lotSize <= 10000) return 3;
    else if (lotSize <= 35000) return 4;
    else if (lotSize <= 150000) return 5;
    else if (lotSize <= 500000) return 6;
    else return 7;
}

// Switching Rule Adjustment
function adjustForSwitchingRule(sampleSize, status) {
    if (status === "tightened") return Math.round(sampleSize * 1.25);
    if (status === "reduced") return Math.round(sampleSize * 0.8);
    return sampleSize;
}

function calculateSampleSize() {

    const lotSize = parseInt(document.getElementById('lotSize').value);
    const inspectionLevel = document.getElementById('inspectionLevel').value;
    const inspectionStatus = document.getElementById('inspectionStatus').value;

    if (isNaN(lotSize) || lotSize < 300) {
        alert("Lot size must be 300 or greater.");
        return;
    }

    const index = getPopulationIndex(lotSize);
    let baseSample = sampleSizeMatrix[inspectionLevel][index];

    currentSampleSize = adjustForSwitchingRule(baseSample, inspectionStatus);

    document.getElementById('sampleSize').textContent =
        `Sample Size (${inspectionStatus.toUpperCase()} - Level ${inspectionLevel}): ${currentSampleSize} units`;

    document.getElementById('defectSection').classList.remove('hidden');
    document.getElementById('result').textContent = "";
}

// Dynamic AQL Calculation
function calculateAcceptance() {

    const defectType = document.getElementById('defectType').value;
    const defectCount = parseInt(document.getElementById('defectCount').value);

    if (isNaN(defectCount)) {
        alert("Please enter number of defects.");
        return;
    }

    let aqlRate;
    if (defectType === "critical") aqlRate = 0.0001;
    if (defectType === "major") aqlRate = 0.01;
    if (defectType === "minor") aqlRate = 0.04;

    const Ac = Math.floor(currentSampleSize * aqlRate);
    const Re = Ac + 1;

    const resultElement = document.getElementById('result');

    if (defectCount <= Ac) {
        resultElement.textContent =
            `ACCEPTED (Ac=${Ac}, Re=${Re}) â€“ Lot meets AQL requirement`;
        resultElement.className = 'result accepted';
    } else {
        resultElement.textContent =
            `REJECTED (Ac=${Ac}, Re=${Re}) â€“ Lot does not meet AQL requirement`;
        resultElement.className = 'result rejected';
    }
}

</script>

</body>
</html>
