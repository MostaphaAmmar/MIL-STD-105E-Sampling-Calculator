<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sampling Plan Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .tab { display: none; }
    .tab.active { display: block; }
    .tabs { margin-bottom: 20px; }
    .tabs button {
      padding: 10px 20px;
      cursor: pointer;
      border: none;
      background-color: #eee;
      margin-right: 5px;
    }
    .tabs button.active { background-color: #ccc; }
    label { display: block; margin-top: 10px; }
    input, select { margin-bottom: 10px; width: 200px; }
    .result { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h1>Sampling Plan Calculator</h1>

  <div class="tabs">
    <button onclick="openTab('milstd')" class="active">MIL-STD-105E</button>
    <button onclick="openTab('binomial')">Binomial Probability</button>
  </div>

  <!-- MIL-STD-105E Tab -->
  <div id="milstd" class="tab active">
    <label for="population">Population Size:</label>
    <input type="number" id="population" min="1">

    <label for="level">Inspection Level:</label>
    <select id="level">
      <option value="I">I</option>
      <option value="II" selected>II</option>
      <option value="III">III</option>
    </select>

    <label for="defectType">Defect Type:</label>
    <select id="defectType">
      <option value="major">Major</option>
      <option value="minor">Minor</option>
      <option value="critical">Critical</option>
    </select>

    <label for="criticality">Criticality:</label>
    <select id="criticality">
      <option value="low">Low</option>
      <option value="medium">Medium</option>
      <option value="high">High</option>
    </select>

    <button onclick="calculateSampling()">Calculate</button>

    <div class="result" id="milstdResult"></div>
  </div>

  <!-- Binomial Probability Tab -->
  <div id="binomial" class="tab">
    <label for="batchNo">Batch No.:</label>
    <input type="text" id="batchNo" placeholder="Enter batch number">

    <label for="n">Sample Size (n):</label>
    <input type="number" id="n" min="1">

    <label for="k">Number of Defectives (k):</label>
    <input type="number" id="k" min="0">

    <label for="p">Defect Rate (p):</label>
    <input type="number" id="p" step="0.0001" min="0" max="1" placeholder="e.g., 0.01 for 1%">

    <button onclick="calculateBinomial()">Calculate Probability</button>

    <div class="result" id="binomialResult"></div>
  </div>

  <script>
    function openTab(tabName) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tabs button').forEach(btn => btn.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');
    }

    function calculateSampling() {
      const pop = parseInt(document.getElementById('population').value);
      const level = document.getElementById('level').value;
      const defectType = document.getElementById('defectType').value;
      const criticality = document.getElementById('criticality').value;

      const resultDiv = document.getElementById('milstdResult');

      if (isNaN(pop) || pop <= 0) {
        resultDiv.innerHTML = "<span style='color:red;'>Please enter a valid population size.</span>";
        return;
      }

      // Dummy logic for demonstration
      const sampleSize = Math.max(2, Math.round(Math.log(pop) * 3));
      const accept = Math.floor(sampleSize * 0.05);
      const reject = accept + 1;

      resultDiv.innerHTML = `
        <strong>Sample Size:</strong> ${sampleSize}<br>
        <strong>Acceptance Number:</strong> ${accept}<br>
        <strong>Rejection Number:</strong> ${reject}
      `;
    }

    function calculateBinomial() {
      const batchNo = document.getElementById('batchNo').value;
      const n = parseInt(document.getElementById('n').value);
      const k = parseInt(document.getElementById('k').value);
      const p = parseFloat(document.getElementById('p').value);

      const resultDiv = document.getElementById('binomialResult');

      if (!batchNo || isNaN(n) || isNaN(k) || isNaN(p) || k > n || p < 0 || p > 1) {
        resultDiv.innerHTML = "<span style='color:red;'>Please enter valid values for all fields.</span>";
        return;
      }

      const binomialCoefficient = (n, k) => {
        const factorial = x => (x <= 1 ? 1 : x * factorial(x - 1));
        return factorial(n) / (factorial(k) * factorial(n - k));
      };

      const coeff = binomialCoefficient(n, k);
      const probability = coeff * Math.pow(p, k) * Math.pow(1 - p, n - k);

      resultDiv.innerHTML = `
        <strong>Batch No:</strong> ${batchNo}<br>
        <strong>Formula:</strong> P(X = ${k}) = C(${n}, ${k}) × ${p}<sup>${k}</sup> × (1 - ${p})<sup>${n - k}</sup><br>
        <strong>Result:</strong> P(X = ${k}) = ${probability.toFixed(6)}
      `;
    }
  </script>

</body>
</html>
